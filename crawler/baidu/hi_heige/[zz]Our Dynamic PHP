                                    <!DOCTYPE html><html  id="customDoc"><!--STATUS OK--> <head> <meta http-equiv=Content-Type content="text/html; charset=utf-8"> <title> [zz]Our Dynamic PHP_5up3rh3i&#39;blog_百度空间</title> <link rel="shortcut icon" href="http://hi.bdimg.com/static/qbase/img/mod/16_favicon.ico?v=116ba471.ico" type=image/x-icon>   <meta name=keywords content="[zz]Our Dynamic PHP,"> <meta name=description content="&lt;script&gt;/*///*/alert(1);&lt;/script&gt;
GTalk:5up3rh3i@gmail.com,[zz]Our Dynamic PHP"><script>window.wpo={start:new Date*1,pid:109,page:'qing'}</script><!--[if IE]><script type="text/javascript">(function(){var e="abbr,article,aside,audio,canvas,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(","),t=e.length;while(t--)document.createElement(e[t])})();</script><![endif]--><script>window.qDomain={"qing":"http://hi.baidu.com","static":"http://hi.bdimg.com","passport":"https://passport.baidu.com","portrait":"http://tx.bdimg.com","hiup":"http://hi.baidu.com","photo":"http://hiphotos.baidu.com","message":"http://msg.baidu.com","friend":"http://frd.baidu.com","mp3":"http://mp3.baidu.com","ting":"http://ting.baidu.com","image":"http://img.baidu.com","qup":"http://upload.hi.baidu.com","www":"http://www.baidu.com"};window.qUserInfo={"userName":"hi_heige","nickname":"hi_heige","portrait":"a93f68695f6865696765fa04","qingUrl":"\/hi_heige","spaceName":"5up3rh3i\&#39;blog","right":"0","avatarStatus":"1","flagNeedInvite":"0","flagNotInvited":"0","version":"2"};window.qVisitorInfo={"userName":"","nickname":"","portrait":"","isHost": false,"isRandUrl": false,"isForceMoved": false,"loginStatus":"not_login","isOldUser":0,"qingUrl":"","right":"0","version":"0"};window.qPageInfo={"pageUrl":"http:\/\/hi.baidu.com\/hi_heige\/item\/06ac54605ff65e2368105b40","referUrl":""};window.qUserAvatar={size20:"http://hiphotos.baidu.com/space/scrop=20;q=100/sign=536115cc0fb30f2431c4ab5cb8a8e373/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size40:"http://hiphotos.baidu.com/space/scrop=40;q=100/sign=275b84b942a7d933bbf6a32cdd76e523/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size65:"http://hiphotos.baidu.com/space/scrop=65;q=100/sign=6a4f52aec895d143de28a37c03cdb437/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size110:"http://hiphotos.baidu.com/space/scrop=110;q=100/sign=b0caf9930cf3d7ca08a8782982228f38/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg",size160:"http://hiphotos.baidu.com/space/scrop=160;q=100/sign=b0caf9930cf3d7ca08a8782982228f3f/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg"};window.qVisitorAvatar={size20:"",size40:"",size65:"",size110:"",size160:""};window.qBdsToken="the fisrt two args should be string type:0,1!";window.qErrorInfo={"no":"0","msg":""};window.qServerInfo={"timeStamp":"1428996222"};window.qLongPolling={"url":"http:\/\/m.hi.baidu.com\/i\/msg\/listen"}</script><!--[if (lt IE 8.0)]><link href="http://hi.bdimg.com/static/qbase/css/qbase.css?v=d097b2a7.css" type=text/css rel=stylesheet><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link href="http://hi.bdimg.com/static/qbase/css/qbase_datauri.css?v=c2391e47.css" type=text/css rel=stylesheet><!--<![endif]-->     <!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment.css?v=5ba753ab.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment_datauri.css?v=a90beb01.css"><!--<![endif]--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qhome/css/common/mod_userInfo.css?v=86bf4259.css">    <!--[if (lt IE 8.0)]><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/n0001/detail.css?v=2247b49c.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/n0001/detail_datauri.css?v=8b3028a2.css"><!--<![endif]-->     <link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qpublish/css/editor/shCoreDefault.css?v=79e715f0.css">  <style type="text/css"></style>     <script src="http://hi.bdimg.com/static/qbase/js/qing/qing.js?v=4d5f41d2.js"></script>  <script>
    /*最终页页面变量*/ 
    window.detailPage = {
        threadId : "06ac54605ff65e2368105b40",
        blogTitle: "[zz]Our Dynamic PHP" || "无标题",
        contentType : "text",
        originAuthorName : "",
        originPortrait : "",
        originThreadId : ""
    }; 
    </script><script>wpo.head=new Date*1;</script> </head> <body>  <header class=mod-topbar id=modTopbar><iframe class=mod-topbar-bgframe></iframe><div class=mod-topbar-pseudo-real><div class="wrapper-box clearfix"><div class=left-box><a href="http://hi.baidu.com" class=logo-box><span id=baiduSpaceLogo class=q-logo></span></a></div> <div class=center-box><ul class=q-menubox>  <li class="q-menuitem q-newicon"> <a href=http://xiangce.baidu.com target=_blank>相册</a>  <li class="q-menuitem " id=qMenuRecommend><a href="http://hi.baidu.com/index/">广场</a><li class="q-menuitem q-newicon q-menu-item-game"><a href=http://youxi.baidu.com/yxpm/pm.jsp?pid=10106000091_970983 target=_blank>游戏</a><div class=q-game-frame><iframe src=about:blank frameborder=no border=0 scrolling=0></iframe></div></ul></div>  <div class=right-box><ul class=q-navbox><li class=q-navitem> <a href="http://hi.baidu.com/go/login">登录</a><li class="q-navitem q-nav-sp"><span></span><li class=q-navitem><a href="http://hi.baidu.com/go/reg?pmfrom=qingtop">注册</a> </ul><div class="right mod-qhome-follow-box"><a href="#" class="follow-btn a-btn-follow qing-stat-nsclick" data-nsclick=20121012follow_hdbtnaddcare>关注此空间</a></div> </div> </div></div></header>  <section class=mod-page-body> <div class="mod-page-main wordwrap clearfix">  <div class=x-page-container>    <section class="mod-topspaceinfo mod-cs-header"><div class=head-topbar></div><div class=container><h1><a class="space-name cs-header-spacename" href="/hi_heige">5up3rh3i&#39;blog</a></h1><p class="space-description cs-header-spacesummary"> /*///*/alert(1); 
GTalk:5up3rh3i@gmail.com</p></div><div class=head-footer></div></section>   <div class=mod-blogpage-wraper> <div class="blog-bg-main-repeat hide"></div>  <div class="grid-80 mod-blogpage"> <div class="blog-bg-main hide"></div>    <div class="mod-text-content mod-post-content mod-cs-contentblock"> <div class=cs-contentblock-bg></div>   <div class="content-head clearfix">  <div class=content-other-info>  <span>2010-05-22 16:25</span>  </div>   <h2 class="title content-title">[zz]Our Dynamic PHP</h2>  </div>  <div id=content class="content mod-cs-content text-content clearfix"> <a href="http://www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html" target="_blank">www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html</a><br /><br />se大牛的MOPS过了这么久，这样出现一片可以推荐下的文章[主要这次大多是Information Leak Vulnerability类型的漏洞]...<br /><br />这篇文章了，大部分的内容以前都有公布过的，不过有一条，以前没什么人提到：<br /><br /><a name="sec24">2.4. Rare but possible cases</a><p>This might not be so spread pitfall of web-developers due to  different kind of usage of following functions. In this case it is often  not required to interact with user input so actively as in previous  examples. But anyway, because these functions are too many they are  worth mention.</p><p>ob_start() function can take argument as callback function that will  be executed when output buffer is flushed. Contents of that was printed  out will be passed to callback function as argument. Usually output  buffering is used for data compression that is passed back to browser.  Let’s consider following malicious usage:</p>&lt;?php<br />$foobar = 'system';<br />ob_start($foobar);<br />echo 'uname';<br />ob_end_flush();<br />?&gt;<p>In case if $foobar is controllable then it would execute system  command “uname”.</p><p>Function assert() is also easy to exploit as eval(), but it is not so  common security hole. It<br />accepts string as argument that will be evaluated. The following code  has the same effect as previous:</p>&lt;?php<br />$foobar = 'system(&quot;uname&quot;)';<br />assert($foobar);<br />?&gt;<p>This function should be used in development code to help in  debugging. And still developers often abuses usage of assert().</p><p>Developers can use array functions to apply some list of properties  to data or vice versa. In most cases applying functions are predefined,  so this vulnerability is also not so popular in the wild. Anyway, it is  still worth mention due to potential possibilities:</p><ul>    <li>array_map()</li>    <li>usort(), uasort(), uksort()</li>    <li>array_filter()</li>    <li>array_reduce()</li>    <li>array_diff_uassoc(), array_diff_ukey()</li>    <li>array_udiff(), array_udiff_assoc(), array_udiff_uassoc()</li>    <li>array_intersect_assoc(), array_intersect_uassoc()</li>    <li>array_uintersect(), array_uintersect_assoc(),  array_uintersect_uassoc()</li>    <li>array_walk(), array_walk_recursive()</li></ul><p>As example let’s take one function of this list and exploit it:</p>&lt;?php<br />$evil_callback = $_GET['callback'];<br />$some_array = array(0, 1,  2, 3);<br />$new_array = array_map($evil_callback, $some_array);<br />?&gt;<p>Now attacker passes this to browser:</p>http://www.example.com/index.php?callback=phpinfo<p>As a result, callback defined by attacker was applied to the whole  array and he will get phpinfo() executed.</p><p>In continue of functions that use callbacks we can mention XML Parser  functions. By default these functions are enabled in PHP:</p><ul>    <li>xml_set_character_data_handler()</li>    <li>xml_set_default_handler()</li>    <li>xml_set_element_handler()</li>    <li>xml_set_end_namespace_decl_handler()</li>    <li>xml_set_external_entity_ref_handler()</li>    <li>xml_set_notation_decl_handler()</li>    <li>xml_set_processing_instruction_handler()</li>    <li>xml_set_start_namespace_decl_handler()</li>    <li>xml_set_unparsed_entity_decl_handler()</li></ul><p>Some other often used functions that were not mentioned but also uses  callbacks:</p><ul>    <li>stream_filter_register()</li>    <li>set_error_handler()</li>    <li>register_shutdown_function()</li>    <li>register_tick_function()</li></ul><p>Here were mentioned functions that might appear in applications, but  there still remains huge amount of undocumented, deprecated functions,  extensions that uses callback functions or otherwise let generate  dynamic code. It is nearly impossible to remember them all. Moreover,  they can appear and disappear in different PHP releases. So, easier and  safer way is to properly sanitize input and to think about what can  influence the value of callback as argument.</p> </div>    <div class="mod-tagbox clearfix"> </div> <div class="mod-post-info clearfix">  <div class=x-bdshare>  <div id=bdshare class="bdshare_t bds_tools get-codes-bdshare" data="{'wbuid':1727466295}"> <span class=bds_more>分享到：</span> <a class=bds_qzone></a> <a class=bds_tsina></a> <a class=bds_tqq></a> <a class=bds_renren></a> </div> <script id=bdshare_js data="type=tools&amp;uid=713670"></script> <script id=bdshell_js></script> <script>
        var bds_config = {'bdTop':240};
                    var all_img = qing.g('content').getElementsByTagName('img');
            if(all_img.length>0){
                bds_config.bdPic = all_img[0].src;
            }
                document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?v=72836429.js?cdnversion=" + Math.ceil(new Date()/3600000);
    </script> </div> <div class="op-box mod-cs-opBox">  <a class="report-btn hide" target=_blank href="#"> 举报 </a>  <span class=pv>浏览(3679)</span> <a class=comment-bnt id=commentBnt href="#" onclick="return false"> 评论<span class=comment-nub></span> </a>   <a href="#" id=shareBnt onclick="return false" class=share-bnt> 转载<span id=shareNub class=share-nub>(1)</span> </a>   </div> </div>   </div>    <div class=mod-share-detail id=shareDetail style=display:none></div>   <div class=mod-relate-blogs id=relateBlog> <h3 class=relate-title>你可能也喜欢</h3> <ul class="relate-blog-list clearfix">   <li  class=first > <a href="http://hi.baidu.com/maqungang/item/d8a4c07e6ae49646ee1e533d" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://b.hiphotos.baidu.com/space/scrop=90/sign=d957c690baa1cd1101e8357fc92ff1cc/54fbb2fb43166d226ec13734462309f79152d2df.jpg" class=relate-img alt="新视野号将拍摄冥王星：画质超哈勃望远镜" title="新视野号将拍摄冥王星：画质超哈勃望远镜"> </a> <a href="http://hi.baidu.com/maqungang/item/d8a4c07e6ae49646ee1e533d" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>新视野号将拍摄冥王星：画质超哈勃望远镜</a>    <li > <a href="http://hi.baidu.com/weiujuwmddeoque/item/33281f2348afba4072863eee" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://f.hiphotos.baidu.com/space/scrop=90/sign=13e6c969afaf2eddd0af0eb6fd2d38d9/0e2442a7d933c895b4ac2f14d21373f08302008a.jpg" class=relate-img alt="科学家破译陨石隐匿线索：地球如何走向毁灭" title="科学家破译陨石隐匿线索：地球如何走向毁灭"> </a> <a href="http://hi.baidu.com/weiujuwmddeoque/item/33281f2348afba4072863eee" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>科学家破译陨石隐匿线索：地球如何走向毁灭</a>    <li > <a href="http://hi.baidu.com/qcyl27/item/d56a336c062358a6c4d24956" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=05323e18aeaf2eddd0af0eb6fd2d38d9/0e2442a7d933c895a278d865d31373f0820200ad.jpg" class=relate-img alt="美行星协会宣布今年试飞太阳帆飞船" title="美行星协会宣布今年试飞太阳帆飞船"> </a> <a href="http://hi.baidu.com/qcyl27/item/d56a336c062358a6c4d24956" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>美行星协会宣布今年试飞太阳帆飞船</a>    <li > <a href="http://hi.baidu.com/klfx8/item/5d977749b78cd5dec0a592c3" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://c.hiphotos.baidu.com/space/scrop=90/sign=f9841e3e61d9f2d3244f63b0d9d1b323/3b292df5e0fe99253e41488f37a85edf8cb1719b.jpg" class=relate-img alt="有趣的日常心理学" title="有趣的日常心理学"> </a> <a href="http://hi.baidu.com/klfx8/item/5d977749b78cd5dec0a592c3" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>有趣的日常心理学</a>    <li > <a href="http://hi.baidu.com/kjzk2013/item/088f56f96bfa8467932af2f3" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://e.hiphotos.baidu.com/space/scrop=90/sign=42c9a33f93529822016d7e9ca7f742fb/b03533fa828ba61eac3957d74234970a314e5976.jpg" class=relate-img alt="《空间周刊》2015年第4期（总第76期）" title="《空间周刊》2015年第4期（总第76期）"> </a> <a href="http://hi.baidu.com/kjzk2013/item/088f56f96bfa8467932af2f3" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>《空间周刊》2015年第4期（总第76期）</a>    <li > <a href="http://hi.baidu.com/80hongyan/item/2bc7289b9f17c943f142152c" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://e.hiphotos.baidu.com/space/scrop=90/sign=5e85b0a26b63f62418037e5cf779d2c8/241f95cad1c8a786658d71956709c93d71cf5081.jpg" class=relate-img alt="丹麦研究人员称上夜班或增加女性患乳腺癌风险" title="丹麦研究人员称上夜班或增加女性患乳腺癌风险"> </a> <a href="http://hi.baidu.com/80hongyan/item/2bc7289b9f17c943f142152c" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>丹麦研究人员称上夜班或增加女性患乳腺癌风险</a>    <li > <a href="http://hi.baidu.com/hi_heige/item/6e4cb870b8363c14d1dcb35b" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://a.hiphotos.baidu.com/space/scrop=90/sign=b8ba13bf720e0cf3a4a909a47a7bcb2f/838ba61ea8d3fd1f69dc1c97304e251f94ca5f41.jpg" class=relate-img alt="[SOBB-07]/[SODB-2010-01]发布" title="[SOBB-07]/[SODB-2010-01]发布"> </a> <a href="http://hi.baidu.com/hi_heige/item/6e4cb870b8363c14d1dcb35b" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>[SOBB-07]/[SODB-2010-01]发布</a>   </ul> </div>   <div class="mod-detail-pager clearfix">  <div class=detail-nav-pre> <a href="http://hi.baidu.com/hi_heige/item/7dd584e9302c51f2e1a5d45f" hidefocus title="上一篇"></a> </div>   <div class=detail-nav-next> <a href="http://hi.baidu.com/hi_heige/item/06aecb12f96f388989a95640" hidefocus title="下一篇"></a> </div>  </div>   <div id=commentDetail class="mod-comment-detail clearfix mod-cs-comment">   <div class=mod-recent-readers> <h3 class=recent-readers-title>本文最近访客</h3> <ul class="readers-list clearfix">    <li  class=first > <a target=_blank href="http://hi.baidu.com/ahhacker86"> <img src="http://hiphotos.baidu.com/space/scrop%3D65%3Bq%3D100/sign%3Df54f73433d6d55fbc19831791d1f797f/0b55b319ebc4b7459071a88bcffc1e178b821541.jpg" title="ahhacker86" alt="ahhacker86" class=portrait> </a> <a target=_blank href="http://hi.baidu.com/ahhacker86" class=user-name title="ahhacker86"> ahhacker86 </a> <div class=visit-time data-visit-time="1355202626"></div>    </ul> </div>  <div class=comment-title>评论</div> <div class=comment-content></div> </div>   </div>  </div>  </div> </div> </section>  <footer class="mod-footer mod-cs-footer"><div class="clearfix hidden-box"></div><div class=footer-box><div class=inner-box><a href=http://help.baidu.com/question?prod_en=hi target=_blank>帮助中心</a><span>&nbsp;|&nbsp;</span><a href=http://tieba.baidu.com/p/1781683739 target=_blank>空间客服</a><span>&nbsp;|&nbsp;</span><a href=http://tousu.baidu.com/hi/add target=_blank>投诉中心</a><span>&nbsp;|&nbsp;</span><a href=http://www.baidu.com/search/hi_contract.html target=_blank>空间协议</a></div><div class=copy-box>&copy;2015&nbsp;Baidu</div></div></footer>  <script src="http://hi.bdimg.com/static/qbase/js/mod/mod_foot.js?v=382c615f.js"></script> <script>
        	qing.dom.ready(function(){
                if (qVisitorInfo.loginStatus == 'activated'){
                    qext.stat.ns('m_20121012_loga_num');
					qext.fn.setStoken();
				}
			});
        </script>        <script>qext.stat.ns('m_20120425_n0001');</script>  <script src="http://hi.bdimg.com/static/qcomment/js/qcmt_import.js?v=ac96f988.js"></script>  <script src="http://hi.bdimg.com/static/qpublish/js/editor/shCore.js?v=805e084f.js"></script> <script>
        SyntaxHighlighter.highlight();
    </script>   <script src="http://hi.bdimg.com/static/qhome/js/detail/20001/detail.js?v=3d7781df.js"></script>   <script>wpo.tti=new Date*1;</script><script src="http://hi.baidu.com/cm/static/js/allsite.js?v=75674092.js?v=201504141523"></script><script>document.write(unescape("%3Cscript src='http://hm.baidu.com/h.js%3F8c869b543955d43e496c2efee5b55823' type='text/javascript'%3E%3C/script%3E"));qext.stat.ns('m_20120713_qing_pv');</script>